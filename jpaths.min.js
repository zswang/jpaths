!function(t){"use strict";function e(t,e){return t.replace(/#\{(.*?)\}/g,function(t,s){return e&&s in e?e[s]:""})}function s(t){var e=[0,0],s=[0,0],i=[];return String(t).replace(/([mlcza])((\s*,?\s*([+-]?\d+(?:\.\d+)?)+)*)/gi,function(t,a,n){switch(a){case"M":case"L":var h=!1;n.replace(/\s*,?\s*([+-]?\d+(?:\.\d+)?)\s*,?\s*([+-]?\d+(?:\.\d+)?)/gi,function(t,n,r){e=[+n,+r],i.push(["L"===a||h?"L":"M",e]),h=!0,"M"===a&&(s=e)});break;case"C":n.replace(/\s*,?\s*([+-]?\d+(?:\.\d+)?)\s*,?\s*([+-]?\d+(?:\.\d+)?)\s*,?\s*([+-]?\d+(?:\.\d+)?)\s*,?\s*([+-]?\d+(?:\.\d+)?)\s*,?\s*([+-]?\d+(?:\.\d+)?)\s*,?\s*([+-]?\d+(?:\.\d+)?)/gi,function(t,s,a,n,h,r,l){e=[0,0],i.push(["C",[+s+e[0],+a+e[1],+n+e[0],+h+e[1],+r+e[0],+l+e[1]]]),e=[+r+e[0],+l+e[1]]});break;case"Z":i.push(["Z"]),e=s}}),i}function i(t){t=t||{},this.parent="string"==typeof t.parent?document.getElementById(t.parent):t.parent||document.body,this.fill=t.fill||"none",this.fillOpacity=t.fillOpacity||t["fill-opacity"]||1,this.stroke=t.stroke||"black",this.strokeWidth=t.strokeWidth||t["stroke-width"]||1,this.strokeOpacity=t.strokeOpacity||t["stroke-opacity"]||1,this.path=t.path||"M 0,0";for(var i,a=c.length-1;a>=0;a--){var n=c[a];if(n.parent===this.parent){i=n;break}}/^canvas$/i.test(this.parent.tagName)&&(o="canvas",this.pathDetails=s(this.path),this.repaint(!0));var h;switch(o){case"canvas":this.canvas=this.parent,i?this.canvasPaths=i.paths:(this.canvasPaths=[],c.push({parent:this.parent,paths:this.canvasPaths})),this.canvasPaths.push(this),this.repaint(!0);break;case"svg":h=document.createElement("div"),h.innerHTML=e('\n<svg width=100% height=100% xmlns="http://www.w3.org/2000/svg">\n  <path fill="#{fill}"\n    fill-rule="evenodd"\n    stroke-linejoin="round"\n    fill-opacity="#{fillOpacity}"\n    stroke="#{stroke}"\n    stroke-opacity="#{strokeOpacity}"\n    stroke-width="#{strokeWidth}" d="#{path}"/>\n</svg>\n',this),this.elementPath=h.lastChild.lastChild,i?(this.element=i.element,this.element.appendChild(this.elementPath)):(this.element=h.lastChild,c.push({parent:this.parent,element:this.element}),this.parent.appendChild(this.element));break;case"vml":h=document.createElement("div"),this.filled="none"==this.fill?"f":"t",this.stroked="none"==this.stroke?"f":"t",this.zoom=r,h.innerHTML=e('\n<v:shape class="jpaths_path_shape jpaths_vml"\n  coordsize="#{zoom},#{zoom}"\n  stroked="#{stroked}"\n  filled="#{filled}"\n  path="#{path}">\n  <v:stroke class="jpaths_vml"\n    opacity="#{strokeOpacity}"\n    color="#{stroke}"\n    weight="#{strokeWidth}">\n  </v:stroke>\n  <v:fill class="jpaths_vml"\n    opacity="#{fillOpacity}"\n    color="#{fill}">\n  </v:fill>\n</v:shape>\n',this),this.elementPath=h.lastChild,i?(this.element=i.element,this.element.appendChild(this.elementPath)):(this.element=h,h.className="jpaths_path_panel",c.push({parent:this.parent,element:this.element}),this.parent.appendChild(this.element)),this.elementFill=this.elementPath.getElementsByTagName("fill")[0],this.elementStroke=this.elementPath.getElementsByTagName("stroke")[0]}}function a(t){return new i(t)}var n=n||{},h=document.all&&document.attachEvent,r=1e3,l=h&&window.XMLHttpRequest&&window.addEventListener&&document.documentMode>=9,o=!h||l?"svg":"vml",c=[];n.format=e,i.prototype.repaint=function(t){if(this.canvas){var e=this.canvas.getContext("2d");if(e){var s;if(t)for(e.save(),e.fillStyle="transparent",e.globalCompositeOperation="copy",e.fillRect(0,0,this.canvas.width,this.canvas.height),e.restore(),s=0;s<this.canvasPaths.length;s++)this.canvasPaths[s].repaint();else if(this.pathDetails){e.save(),e.beginPath();var i=[0,0],a=[0,0];for(s=0;s<this.pathDetails.length;s++){var n=this.pathDetails[s];switch(n[0]){case"Z":e.closePath(),i=a;break;case"C":e.bezierCurveTo(n[1][0],n[1][1],n[1][2],n[1][3],n[1][4],n[1][5]),i=[n[1][2],n[1][3]];break;case"L":i=[n[1][0],n[1][1]],e.lineTo(n[1][0],n[1][1]);break;case"M":i=[n[1][0],n[1][1]],a=[n[1][0],n[1][1]],e.moveTo(n[1][0],n[1][1])}}"none"!==this.stroke&&(e.strokeStyle=this.stroke,e.stroke()),e.lineWidth=this.strokeWidth,"none"!==this.fill&&(e.fillStyle=this.fill,e.fill()),e.restore()}}}},i.prototype.attr=function(t,e,i){if(!this.freed)if(1===arguments.length){if("string"==typeof t)return"stroke-width"===t&&(t="strokeWidth"),this[t];if("object"==typeof t){for(var a in t)this.attr(a,t[a],!0);return this}}else if(arguments.length>1){switch(t){case"path":if(this.path===e)break;switch(this.path=e,o){case"svg":this.elementPath.setAttribute("d",e||"M 0,0");break;case"vml":this.elementPath.path=String(e||"M 0,0").replace(/\d+(\.\d+)?/g,function(t){return parseInt(t*r)}).replace(/z/gi,"X");break;case"canvas":this.pathDetails=s(this.path),this.repaint(!0)}break;case"fill":if(this.fill===e)break;switch(this.fill=e,o){case"svg":this.elementPath.setAttribute("fill",e);break;case"vml":this.elementPath.Filled=this.filled="none"===this.fill?"f":"t",this.elementFill.Color=e;break;case"canvas":i&&this.repaint(!0)}break;case"stroke":if(this.stroke===e)break;switch(this.stroke=e,o){case"svg":this.elementPath.setAttribute("stroke",e);break;case"vml":this.elementPath.Stroked=this.stroked="none"===this.stroke?"f":"t",this.elementStroke.Color=e;break;case"canvas":i&&this.repaint(!0)}break;case"fillOpacity":case"fill-opacity":if(this.fillOpacity===e)break;switch(this.fillOpacity=e,o){case"svg":this.elementPath.setAttribute("fill-opacity",e);break;case"vml":this.elementFill.Opacity=Math.min(Math.max(0,e),1);break;case"canvas":i&&this.repaint(!0)}break;case"strokeOpacity":case"stroke-opacity":if(this.strokeOpacity===e)break;switch(this.strokeOpacity=e,o){case"svg":this.elementPath.setAttribute("stroke-opacity",e);break;case"vml":this.elementStroke.Opacity=Math.min(Math.max(0,e),1);break;case"canvas":i&&this.repaint(!0)}break;case"strokeWidth":case"stroke-width":if(this.strokeWidth==e)break;switch(this.strokeWidth=e,o){case"svg":this.elementPath.setAttribute("stroke-width",e);break;case"vml":this.elementStroke.weight=e;break;case"canvas":i&&this.repaint(!0)}}return this}},i.prototype.free=function(){if(!this.freed)switch(this.freed=!0,o){case"svg":case"vml":this.elementPath.parentNode.removeChild(this.elementPath),this.elementPath=null;break;case"canvas":for(var t=0;t<this.canvasPaths.length;t++)if(this.canvasPaths[t]===this){this.canvasPaths.splice(t,1),this.repaint(!0);break}}},n.create=a,"vml"===o&&(document.createStyleSheet().cssText=e("\n.#{this}_vml {\n  behavior: url(#default#VML);\n}\n.#{this}_path_shape {\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: 0;\n  left: 0;\n  top: 0;\n  position: absolute;\n}\n.#{this}_path_panel {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  padding: 0;\n  margin: 0;\n  position: relative;\n}\n",t)),"function"==typeof define?(define.amd||define.cmd)&&define(function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:window[t]=n}("jpaths");